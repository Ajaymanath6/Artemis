<!-- Alert Panel Container -->
<div class="w-full bg-white flex flex-col flex-shrink-0 overflow-hidden relative" 
     style="height: 100vh;"
     [class]="isStatic ? 'static w-96 flex-shrink-0 overflow-hidden' : ''">
  
  <!-- Panel Header -->
  <div class="px-4 py-1 border-b border-gray-200 bg-gray-100 flex items-center justify-between flex-shrink-0 min-h-[50px]">
    <div class="flex items-center gap-3">
      <!-- Back Button (only show when in case detail view) -->
    <button 
        *ngIf="showCaseDetail"
        (click)="onBackFromCaseDetail()" 
        class="bg-transparent border-none cursor-pointer p-2 rounded-md text-gray-500 transition-all duration-200 hover:bg-gray-100 hover:text-gray-700"
        title="Back to alerts">
        <i class="ri-arrow-left-line text-xl"></i>
    </button>
      <h2 class="text-xl font-semibold text-gray-900 m-0">
        {{ showCaseDetail ? 'Case Details' : 'Alerts' }}
      </h2>
    </div>
  </div>

  <!-- Panel Content -->
  <div class="flex-1 overflow-y-auto p-4 min-h-0">
    
    
    <!-- Case Detail View -->
    <div *ngIf="showCaseDetail && selectedCase" class="case-detail-view">
      <!-- Case Title -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-[#146B85] mb-2">{{ selectedCase.title }}</h3>
        <div class="flex items-center gap-2 mb-4">
          <span *ngIf="selectedCase.badge" class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium" 
                style="background-color: #E5E7EB; color: #374151;">
            {{ selectedCase.badge }}
          </span>
        </div>
      </div>
      
      <!-- Case Details Grid -->
      <div class="space-y-4 mb-6">
        <div class="grid grid-cols-1 gap-4">
          <div class="bg-gray-50 p-3 rounded-lg">
            <div class="text-xs font-semibold text-gray-500 mb-1">CASE ID</div>
            <div class="text-sm font-medium text-gray-900">{{ selectedCase.caseId }}</div>
          </div>
          <div class="bg-gray-50 p-3 rounded-lg">
            <div class="text-xs font-semibold text-gray-500 mb-1">COURT</div>
            <div class="text-sm font-medium text-gray-900">{{ selectedCase.court }}</div>
          </div>
          <div class="bg-gray-50 p-3 rounded-lg">
            <div class="text-xs font-semibold text-gray-500 mb-1">DATE</div>
            <div class="text-sm font-medium text-gray-900">{{ selectedCase.date }}</div>
          </div>
          <div class="bg-gray-50 p-3 rounded-lg">
            <div class="text-xs font-semibold text-gray-500 mb-1">TYPE</div>
            <div class="text-sm font-medium text-gray-900">{{ selectedCase.type }}</div>
          </div>
          <div class="bg-gray-50 p-3 rounded-lg">
            <div class="text-xs font-semibold text-gray-500 mb-1">STATUS</div>
            <div class="text-sm font-medium text-gray-900">
              <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium" 
                    style="background-color: #E5E7EB; color: #374151;">
                {{ selectedCase.status }}
              </span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Case Description -->
      <div class="mb-6">
        <div class="text-xs font-semibold text-gray-500 mb-2">CASE DESCRIPTION</div>
        <div class="bg-gray-50 p-4 rounded-lg">
          <p class="text-sm text-gray-700 leading-relaxed">
            This case involves complex legal proceedings related to {{ selectedCase.type.toLowerCase() }} matters. 
            The case is currently in {{ selectedCase.status.toLowerCase() }} status and is being handled by {{ selectedCase.court }}.
            Key developments and documentation are being tracked as the case progresses through the judicial system.
          </p>
        </div>
      </div>
      
      <!-- Recent Activity -->
      <div class="mb-6">
        <div class="text-xs font-semibold text-gray-500 mb-2">RECENT ACTIVITY</div>
        <div class="space-y-3">
          <div class="bg-gray-50 p-3 rounded-lg">
            <div class="flex items-start gap-3">
              <i class="ri-file-text-line text-[#146B85] text-sm mt-0.5"></i>
              <div class="flex-1">
                <div class="text-sm font-medium text-gray-900">New document filed</div>
                <div class="text-xs text-gray-600">Motion for summary judgment submitted</div>
                <div class="text-xs text-gray-500 mt-1">{{ selectedCase.lastUpdated }}</div>
              </div>
            </div>
          </div>
          <div class="bg-gray-50 p-3 rounded-lg">
            <div class="flex items-start gap-3">
              <i class="ri-calendar-line text-[#146B85] text-sm mt-0.5"></i>
              <div class="flex-1">
                <div class="text-sm font-medium text-gray-900">Hearing scheduled</div>
                <div class="text-xs text-gray-600">Next court appearance set for review</div>
                <div class="text-xs text-gray-500 mt-1">3 days ago</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Alert Form View (default) -->
    <div *ngIf="!showCaseDetail">
      <!-- New Alert Title -->
      <div class="mb-4">
        <h3 class="text-lg font-semibold text-gray-900">{{ getHeaderTitle() }}</h3>
      </div>
      
      <!-- Divider -->
      <div class="border-t border-gray-200 mb-4"></div>
    
    <!-- Instant Email Alert Toggle -->
    <div class="mb-5 flex items-center justify-between p-3 bg-gray-50 rounded-lg">
      <div class="flex items-center gap-2">
        <span class="text-sm font-medium text-gray-900">Instant email alert</span>
        <i class="ri-information-line text-gray-500 cursor-help" title="Get notified immediately when new cases match your criteria"></i>
      </div>
      <button 
        class="relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#146B85] focus:ring-offset-2"
        [class]="instantEmailEnabled ? 'bg-[#146B85]' : 'bg-gray-300'"
        (click)="toggleInstantEmail()">
        <span class="inline-block h-3 w-3 transform rounded-full bg-white transition-transform"
              [class]="instantEmailEnabled ? 'translate-x-5' : 'translate-x-1'"></span>
      </button>
    </div>
    
    <!-- Research Question Section -->
    <div class="mb-5">
      <label class="block text-xs font-semibold text-gray-700 mb-2">Research Question</label>
      <textarea 
        [(ngModel)]="alertData.researchQuestion"
        placeholder="Enter your research question..."
        rows="2"
        class="w-full p-2 border border-gray-300 rounded-lg text-xs text-gray-900 transition-colors focus:outline-none focus:border-[#146B85] focus:ring-3 focus:ring-[#146B85]/10 resize-vertical min-h-[3rem] box-border"
        (input)="onResearchQuestionChange()">
      </textarea>
    </div>
    
    </div>
    <!-- End A
       <div *ngIf="!showCaseDetail" class="px-6 py-4 border-t border-gray-200 bg-white flex gap-3 flex-shrink-0">
    <button 
      (click)="onCancel()" 
      class="flex-1 px-6 py-3 bg-white text-gray-700 border border-gray-300 rounded-lg text-sm font-medium cursor-pointer transition-all duration-200 hover:bg-gray-50 hover:border-gray-400">
      Cancel
    </button>
    <button 
      (click)="onSave()" 
      class="flex-1 px-6 py-3 bg-[#146B85] text-white border border-[#146B85] rounded-lg text-sm font-medium cursor-pointer transition-all duration-200 hover:bg-[#0f5462] hover:border-[#0f5462] disabled:bg-gray-400 disabled:border-gray-400 disabled:cursor-not-allowed disabled:opacity-60"
      [disabled]="!isFormValid()">
      Save this alert
    </button>
  </div>

  </div>

  <!-- Panel Footer - Inside Panel (only show for alert creation) -->
  <div *ngIf="!showCaseDetail" class="px-6 py-4 border-t border-gray-200 bg-white flex gap-3 flex-shrink-0">
    <button 
      (click)="onCancel()" 
      class="flex-1 px-6 py-3 bg-white text-gray-700 border border-gray-300 rounded-lg text-sm font-medium cursor-pointer transition-all duration-200 hover:bg-gray-50 hover:border-gray-400">
      Cancel
    </button>
    <button 
      (click)="onSave()" 
      class="flex-1 px-6 py-3 bg-[#146B85] text-white border border-[#146B85] rounded-lg text-sm font-medium cursor-pointer transition-all duration-200 hover:bg-[#0f5462] hover:border-[#0f5462] disabled:bg-gray-400 disabled:border-gray-400 disabled:cursor-not-allowed disabled:opacity-60"
      [disabled]="!isFormValid()">
      Save this alert
    </button>
  </div>

</div>