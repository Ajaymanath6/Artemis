<!-- Search Bar Component -->
<div class="w-4/5 mx-auto">
  
  <!-- Search Type Selection -->
  <div class="mb-6">
    <h2 class="text-sm font-bold text-gray-900 mb-4 uppercase">Search For</h2>
    <div class="flex items-center space-x-4">
      <button
        *ngFor="let type of searchTypes"
        (click)="selectSearchType(type)"
        class="flex items-center space-x-2 h-9 px-4 py-3 rounded-lg transition-colors"
        [class]="selectedSearchType.id === type.id ? 
          'bg-gray-light text-gray-700' : 
          'text-gray-700 hover:bg-gray-100'">
        <i [class]="'ri-' + type.icon + ' text-base'" 
           [style.color]="'#374151'"></i>
        <span class="font-medium text-sm">{{ type.label }}</span>
      </button>
    </div>
  </div>

  <!-- Main Search Container -->
  <div class="relative">
    <!-- Search Input Area -->
    <div class="bg-white border border-stroke-weak rounded-lg">
      
      <!-- Top Section - Search Input -->
      <div class="flex items-center px-4 py-4">
        <div class="flex-1 relative">
          <input
            type="text"
            [(ngModel)]="searchQuery"
            (keyup)="onKeyPress($event)"
            placeholder="Ask the researcher"
            class="w-full pr-4 py-2 bg-transparent focus:outline-none placeholder-opacity-30 text-lg border-none"
          />
        </div>
      </div>

      <!-- Pro and Filter Section - Same Line -->
      <div class="flex items-center justify-between px-4 pb-4 relative">
        <!-- Pro Section -->
        <div class="relative">
          <button 
            (click)="toggleProDropdown()"
            class="flex items-center space-x-2 text-text-strong hover:text-brand transition-colors border-0 px-3 py-2 rounded-lg hover:bg-gray-50" 
            style="outline: none; border: #00000000;">
            <i class="ri-sparkling-fill text-lg" style="color: #147885;"></i>
            <span class="underline text-sm font-medium">Natural Language</span>
            <i class="ri-arrow-down-s-line" style="color: #353D59; font-size: 14px;"></i>
          </button>

          <!-- Pro Dropdown -->
          <div 
            *ngIf="isProDropdownOpen"
            class="absolute top-full left-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50">
            
            <!-- Option 1 -->
            <div class="px-4 py-3 hover:bg-gray-50 cursor-pointer" (click)="selectProOption('natural')">
              <div class="flex items-center space-x-3">
                <div class="flex items-center space-x-3 flex-1">
                  <i class="ri-sparkling-fill text-lg" style="color: #69718C;"></i>
                  <div class="flex-1">
                    <h4 class="text-sm font-medium text-text-strong">Natural Language</h4>
                    <p class="text-xs text-text-weak">Standard natural language processing</p>
                  </div>
                </div>
                <div class="flex items-center">
                  <input 
                    type="radio" 
                    name="proOption" 
                    value="natural"
                    [checked]="selectedProOption === 'natural'"
                    class="w-4 h-4 text-brand focus:ring-brand border-gray-300">
                </div>
              </div>
            </div>

            <!-- Option 2 -->
            <div class="px-4 py-3 hover:bg-gray-50 cursor-pointer" (click)="selectProOption('advanced')">
              <div class="flex items-center space-x-3">
                <div class="flex items-center space-x-3 flex-1">
                  <i class="ri-flow-chart text-lg" style="color: #69718C;"></i>
                  <div class="flex-1">
                    <h4 class="text-sm font-medium text-text-strong">Advanced</h4>
                    <p class="text-xs text-text-weak">Advanced AI features and capabilities</p>
                  </div>
                </div>
                <div class="flex items-center">
                  <input 
                    type="radio" 
                    name="proOption" 
                    value="advanced"
                    [checked]="selectedProOption === 'advanced'"
                    class="w-4 h-4 text-brand focus:ring-brand border-gray-300">
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Filter and Search Section -->
        <div class="flex items-center space-x-3">
          <!-- Filter Section -->
          <button 
            (click)="toggleFilterPanel()"
            class="flex items-center space-x-2 text-text-strong hover:text-brand transition-colors border-0 px-3 py-2 rounded-lg hover:bg-gray-50" 
            style="outline: none; border: #00000000;">
            <i class="ri-filter-line text-lg" style="color: #147885;"></i>
            <span class="underline text-sm font-medium">Filter</span>
          </button>

          <!-- Search Button -->
          <button 
            [disabled]="!searchQuery || searchQuery.trim().length === 0"
            (click)="onSearch()"
            class="w-9 h-9 rounded-lg transition-colors flex items-center justify-center ml-3"
            [style.background-color]="searchQuery && searchQuery.trim().length > 0 ? '#147885' : 'rgba(20, 120, 133, 0.5)'">
            <i class="ri-arrow-right-long-line text-white text-lg"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Filter Side Panel - full overlay -->
  <div 
    class="fixed inset-0 z-50 overflow-hidden transition-opacity duration-300"
    [ngClass]="{
      'opacity-100 pointer-events-auto': isFilterPanelOpen,
      'opacity-0 pointer-events-none': !isFilterPanelOpen
    }">
    
    <!-- Backdrop -->
    <div 
      class="absolute inset-0 bg-gray-900 bg-opacity-10 transition-opacity duration-300"
      [ngClass]="{
        'opacity-100': isFilterPanelOpen,
        'opacity-0': !isFilterPanelOpen
      }"
      (click)="closeFilterPanel()">
    </div>
    
    <!-- Side Panel -->
    <div 
      class="absolute right-0 top-0 h-full w-80 bg-white shadow-xl transition-transform duration-500 ease-out"
      [ngClass]="{
        'translate-x-0': isFilterPanelOpen,
        'translate-x-full': !isFilterPanelOpen
      }"
      [@slideIn]="isFilterPanelOpen ? 'in' : 'out'">
      
      <!-- Panel Header -->
      <div class="flex items-center justify-between px-6 py-4 border-b border-gray-200">
        <h2 class="text-lg font-semibold text-gray-900">Filters</h2>
        <button 
          (click)="closeFilterPanel()"
          class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
          <i class="ri-close-line text-xl text-gray-500"></i>
        </button>
      </div>
      
      <!-- Panel Content -->
      <div class="p-6">
        <div class="space-y-6">
          
          <!-- Date Range Filter -->
          <div>
            <h3 class="text-sm font-medium text-gray-900 mb-3">Date Range</h3>
            <div class="space-y-2">
              <input 
                type="date" 
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand">
              <input 
                type="date" 
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand">
            </div>
          </div>
          
          <!-- Case Type Filter -->
          <div>
            <h3 class="text-sm font-medium text-gray-900 mb-3">Case Type</h3>
            <div class="space-y-2">
              <label class="flex items-center">
                <input type="checkbox" class="rounded border-gray-300 text-brand focus:ring-brand">
                <span class="ml-2 text-sm text-gray-700">Civil</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" class="rounded border-gray-300 text-brand focus:ring-brand">
                <span class="ml-2 text-sm text-gray-700">Criminal</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" class="rounded border-gray-300 text-brand focus:ring-brand">
                <span class="ml-2 text-sm text-gray-700">Corporate</span>
              </label>
            </div>
          </div>
          
          <!-- Jurisdiction Filter -->
          <div>
            <h3 class="text-sm font-medium text-gray-900 mb-3">Jurisdiction</h3>
            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand">
              <option>All Jurisdictions</option>
              <option>Federal</option>
              <option>State</option>
              <option>Local</option>
            </select>
          </div>
          
        </div>
      </div>
      
      <!-- Panel Footer -->
      <div class="absolute bottom-0 left-0 right-0 px-6 py-4 border-t border-gray-200 bg-white">
        <div class="flex space-x-3">
          <button 
            (click)="clearFilters()"
            class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
            Clear All
          </button>
          <button 
            (click)="applyFilters()"
            class="flex-1 px-4 py-2 bg-brand text-white rounded-lg hover:bg-teal-700 transition-colors">
            Apply Filters
          </button>
        </div>
      </div>
      
    </div>
  </div>
</div>
